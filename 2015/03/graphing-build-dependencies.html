<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>Dependency Management - Modeling Suppliers and Consumers pt.1</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="keywords" content="">
    <meta name="generator" content="JBake">

    <!-- Le styles -->
    <link href="../../css/bootstrap.min.css" rel="stylesheet">
    <link href="../../css/asciidoctor.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <link href="../../css/prettify.css" rel="stylesheet"><link href='http://fonts.googleapis.com/css?family=Lato:300,400' rel='stylesheet' type='text/css'><link href='http://fonts.googleapis.com/css?family=Abel' rel='stylesheet' type='text/css'>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->

    <!-- Fav and touch icons -->
    <!--<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="../assets/ico/apple-touch-icon-57-precomposed.png">-->
    <link rel="shortcut icon" href="../../favicon.ico">
  </head>
  <body onload="prettyPrint()">
    <div id="wrap">

	<!-- Fixed navbar -->
    <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../../">Sion's Blog</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="../../index.html">Home</a></li>
            <li><a href="../../about.html">About</a></li>
            <li><a href="../../feed.xml">Subscribe</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>
    <div class="container">

	<div class="page-header">
		<h1>Dependency Management - Modeling Suppliers and Consumers pt.1</h1>
	</div>

	<p><em>07 March 2015</em></p>
	<p><em>Tags: </em>
		<a href="/blog/tags/gradle.html">gradle</a>
	</em>
		<a href="/blog/tags/maven.html"> maven</a>
	</em>
		<a href="/blog/tags/pom.html"> pom</a>
	</em>
		<a href="/blog/tags/dependencies.html"> dependencies</a>
	</em>
		<a href="/blog/tags/graph.html"> graph</a>
	</p>

	<p><div class="sect1">
<h2 id="_introduction">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Dependency management has come a long way over the past 10 years, but I believe it has some way to go before we can say the problem is solved.</p>
</div>
<div class="paragraph">
<p>Consider the scenario where you have developed a library which inadvertently introduced a severe security vulnerability. Because your organisation believes in reuse it has been used in many different projects. The Maven POM (Project Object Model) does a good job in providing us with meta-data about the modules which are <em>suppliers</em> to a project, but it doesn&#8217;t capture information about who the <em>consumers</em> are.</p>
</div>
<div class="paragraph">
<p>So, we have a dangerous library in the wild, but we cant say with any certainty who is consuming it. At this point the only solution is to trawl through every projects POM and look to see if you have declared this library as a dependency. This is going to make your day very unpleasant if you have more than a hand full of projects, and if you&#8217;ve moved in the direction of microservices then this is going to be hell!</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_a_potential_solution">A potential solution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As I mentioned earlier a Maven POM provides us with a way of describing what dependencies a project has. These are identified using a standard set of attributes; <em>groupId</em>, <em>artifactId</em> and <em>version</em>. There are other attributes, but we will ignore them for now.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>groupId</em> - a macro group or family of projects or archives to which a project belongs. For example, <code>org.hibernate</code> and <code>org.richfaces.ui</code></p>
</li>
<li>
<p><em>artifactId</em> - the unique identifier of the project among the projects sharing the same <code>groupId</code>. For example, <code>junit</code>, <code>hibernate-annotations</code>, and <code>richfaces-components-ui</code>.</p>
</li>
<li>
<p><em>version</em> - a version number.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Lets turn our dependency tree into a graphical representation:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="http://site.kuali.org/maven/plugins/graph-maven-plugin/1.2.3/graph/direct/compile/flat.png" alt="flat">
</div>
</div>
<div class="paragraph">
<p>Wouldn&#8217;t it be good if we could store all of these project graphs in a single location where they could establish relationships with other projects?</p>
</div>
<div class="paragraph">
<p>We&#8217;re already talking about graphs, so wouldn&#8217;t a graph database be a good place to start?</p>
</div>
<div class="sect2">
<h3 id="_describing_the_domain">Describing the domain</h3>
<div class="paragraph">
<p>The underlying data model of a graph database is whats called the Property Graph data model. Essentially, it means that we will be storing our data in a graph database, and that we will be using vertices and edges(or nodes and relationships) to persist our data.</p>
</div>
<div class="paragraph">
<p>This works really well for the problem we&#8217;re trying to solve because we&#8217;re talking about artifacts (nodes), and their relationships with each other artifacts. Lets look at some code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint groovy language-groovy"><code>@NodeEntity
public class Artifact {

    @GraphId Long id
    String groupId
    String artifactId
    String version

    @RelatedTo(type = "DEPENDS_ON", direction = Direction.OUTGOING)
    public @Fetch Set&lt;Artifact&gt; dependencies


    public void dependsOn(Artifact artifact) {
        if ( !dependencies ) {
            dependencies == new HashSet&lt;Artifact&gt;()
        }
        dependencies.add(artifact)
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
I&#8217;m using Spring heavily here - this may look unfamiliar if you don&#8217;t know Spring.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Here you can see I&#8217;ve constructed the node using the attributes I defined earlier. There is an id which is annotated with <code>@GraphId</code> that Neo4j uses to track the data, a groupId, artifactId and version. Inside this node entity I have also defined a <code>Set&lt;Artifact&gt;</code> of dependencies marked up as <code>@RelatedTo</code>. This means that every member of this set is expected to also exist as a separate <code>Artifact</code> node, and this node <code>DEPENDS_ON</code> them.</p>
</div>
<div class="paragraph">
<p>So, this concludes part 1. Pt2 coming soon..</p>
</div>
</div>
</div>
</div></p>

	<hr>

	<!-- **** DISQUS **** -->
	<div id="disqus_thread"></div>
	<script type="text/javascript">
		/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
		var disqus_shortname = 'willis7'; // required: replace example with your forum shortname
		var disqus_identifier = '2015/03/graphing-build-dependencies.html';
    	var disqus_title = "Dependency Management - Modeling Suppliers and Consumers pt.1";
    	var disqus_url = 'https://willis7.github.io/blog2015/03/graphing-build-dependencies.html';

		/* * * DON'T EDIT BELOW THIS LINE * * */
		(function() {
			var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
			dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
			(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
		})();
	</script>
	<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
	<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
	<!-- **** END **** -->

	<!-- **** ANALYTICS **** -->
	<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	  ga('create', 'UA-60966243-1', 'auto');
	  ga('send', 'pageview');

	</script>
	<!-- **** END **** -->

		</div>
		<div id="push"></div>
    </div>
    
    <div id="footer">
      <div class="container">
        <p class="muted credit">&copy; 2014 | Mixed with <a href="http://getbootstrap.com/">Bootstrap v3.1.1</a> | Baked with <a href="http://jbake.org">JBake v2.3.0</a></p>
      </div>
    </div>
    
    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../../js/jquery-1.11.1.min.js"></script>
    <script src="../../js/bootstrap.min.js"></script>
    <script src="../../js/prettify.js"></script>

    <!-- **** DISQUS **** -->
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'willis7'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script'); s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <!-- **** END **** -->
    
  </body>
</html>